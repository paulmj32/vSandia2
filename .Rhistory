values = lty_vec,
labels = c("Actual",
bquote("BART (" * R^2 ~ "=" ~ .(rsq_bart_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_bart_wind) * ")"),
bquote("eNET (" * R^2 ~ "=" ~ .(rsq_lre_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_lre_wind) * ")"),
bquote("XGB (" * R^2 ~ "=" ~ .(rsq_xgb_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_xgb_wind) * ")")
),
name = element_blank()) +
scale_alpha_manual(
values = alpha_vec,
labels = c("Actual",
bquote("BART (" * R^2 ~ "=" ~ .(rsq_bart_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_bart_wind) * ")"),
bquote("eNET (" * R^2 ~ "=" ~ .(rsq_lre_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_lre_wind) * ")"),
bquote("XGB (" * R^2 ~ "=" ~ .(rsq_xgb_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_xgb_wind) * ")")
),
name = element_blank()) +
scale_y_continuous(labels = function(x) paste0(x)) +
xlab("County") +
#ylab(expression("Pr"~(list("Number of Invasions",X>=x))))+
ylab(expression("Annual Sustained Winds"~list("Number of Invasions",X>=x))) +
#ylab(paste(expression("Annual Sustained Winds \u2265 34 knots (ln - hrs)"))) +
#ylab("Annual Sustained Winds >= 34 knots (ln - hrs)") +
ggtitle("Exposure to Tropical Storms: Test Sample") +
# guides(
#   color = guide_legend(order = 2),
#   shape = guide_legend(order = 1),
#   linetype = guide_legend(order = 2)
# ) +
theme(legend.spacing.y = unit(-0.25, "cm"),
legend.direction = "vertical",
legend.box = "vertical",
legend.position = c(.225, .85),
plot.title = element_text(hjust = 0.5)
)
print(p)
}
plot_filtering_estimates2(gg)
plot_filtering_estimates2 <- function(df) {
p = ggplot() +
theme_classic() +
geom_hline(yintercept = mean(gg_wind$actual, na.rm = T), linetype="dashed", color = "gray50", alpha = 0.85) +
geom_line(data = gg_wind_all, aes(x = index, y = ypred, color = Model, lty = Model, alpha = Model)) +
scale_color_manual(
values = color_vec,
labels = c("Actual",
bquote("BART (" * R^2 ~ "=" ~ .(rsq_bart_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_bart_wind) * ")"),
bquote("eNET (" * R^2 ~ "=" ~ .(rsq_lre_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_lre_wind) * ")"),
bquote("XGB (" * R^2 ~ "=" ~ .(rsq_xgb_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_xgb_wind) * ")")
),
name = element_blank()) +
scale_linetype_manual(
values = lty_vec,
labels = c("Actual",
bquote("BART (" * R^2 ~ "=" ~ .(rsq_bart_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_bart_wind) * ")"),
bquote("eNET (" * R^2 ~ "=" ~ .(rsq_lre_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_lre_wind) * ")"),
bquote("XGB (" * R^2 ~ "=" ~ .(rsq_xgb_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_xgb_wind) * ")")
),
name = element_blank()) +
scale_alpha_manual(
values = alpha_vec,
labels = c("Actual",
bquote("BART (" * R^2 ~ "=" ~ .(rsq_bart_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_bart_wind) * ")"),
bquote("eNET (" * R^2 ~ "=" ~ .(rsq_lre_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_lre_wind) * ")"),
bquote("XGB (" * R^2 ~ "=" ~ .(rsq_xgb_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_xgb_wind) * ")")
),
name = element_blank()) +
scale_y_continuous(labels = function(x) paste0(x)) +
xlab("County") +
#ylab(expression("Pr"~(list("Number of Invasions",X>=x))))+
ylab(expression("Annual Sustained Winds"~list("Number of Invasions"X>=x))) +
plot_filtering_estimates2(gg)
plot_filtering_estimates2 <- function(df) {
p = ggplot() +
theme_classic() +
geom_hline(yintercept = mean(gg_wind$actual, na.rm = T), linetype="dashed", color = "gray50", alpha = 0.85) +
geom_line(data = gg_wind_all, aes(x = index, y = ypred, color = Model, lty = Model, alpha = Model)) +
scale_color_manual(
values = color_vec,
labels = c("Actual",
bquote("BART (" * R^2 ~ "=" ~ .(rsq_bart_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_bart_wind) * ")"),
bquote("eNET (" * R^2 ~ "=" ~ .(rsq_lre_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_lre_wind) * ")"),
bquote("XGB (" * R^2 ~ "=" ~ .(rsq_xgb_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_xgb_wind) * ")")
),
name = element_blank()) +
scale_linetype_manual(
values = lty_vec,
labels = c("Actual",
bquote("BART (" * R^2 ~ "=" ~ .(rsq_bart_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_bart_wind) * ")"),
bquote("eNET (" * R^2 ~ "=" ~ .(rsq_lre_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_lre_wind) * ")"),
bquote("XGB (" * R^2 ~ "=" ~ .(rsq_xgb_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_xgb_wind) * ")")
),
name = element_blank()) +
scale_alpha_manual(
values = alpha_vec,
labels = c("Actual",
bquote("BART (" * R^2 ~ "=" ~ .(rsq_bart_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_bart_wind) * ")"),
bquote("eNET (" * R^2 ~ "=" ~ .(rsq_lre_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_lre_wind) * ")"),
bquote("XGB (" * R^2 ~ "=" ~ .(rsq_xgb_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_xgb_wind) * ")")
),
name = element_blank()) +
scale_y_continuous(labels = function(x) paste0(x)) +
xlab("County") +
#ylab(expression("Pr"~(list("Number of Invasions",X>=x))))+
ylab(expression("Annual Sustained Winds"~list("Number of Invasions"X>=x))) +
plot_filtering_estimates2(gg)
plot_filtering_estimates2 <- function(df) {
p = ggplot() +
theme_classic() +
geom_hline(yintercept = mean(gg_wind$actual, na.rm = T), linetype="dashed", color = "gray50", alpha = 0.85) +
geom_line(data = gg_wind_all, aes(x = index, y = ypred, color = Model, lty = Model, alpha = Model)) +
scale_color_manual(
values = color_vec,
labels = c("Actual",
bquote("BART (" * R^2 ~ "=" ~ .(rsq_bart_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_bart_wind) * ")"),
bquote("eNET (" * R^2 ~ "=" ~ .(rsq_lre_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_lre_wind) * ")"),
bquote("XGB (" * R^2 ~ "=" ~ .(rsq_xgb_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_xgb_wind) * ")")
),
name = element_blank()) +
scale_linetype_manual(
values = lty_vec,
labels = c("Actual",
bquote("BART (" * R^2 ~ "=" ~ .(rsq_bart_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_bart_wind) * ")"),
bquote("eNET (" * R^2 ~ "=" ~ .(rsq_lre_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_lre_wind) * ")"),
bquote("XGB (" * R^2 ~ "=" ~ .(rsq_xgb_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_xgb_wind) * ")")
),
name = element_blank()) +
scale_alpha_manual(
values = alpha_vec,
labels = c("Actual",
bquote("BART (" * R^2 ~ "=" ~ .(rsq_bart_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_bart_wind) * ")"),
bquote("eNET (" * R^2 ~ "=" ~ .(rsq_lre_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_lre_wind) * ")"),
bquote("XGB (" * R^2 ~ "=" ~ .(rsq_xgb_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_xgb_wind) * ")")
),
name = element_blank()) +
scale_y_continuous(labels = function(x) paste0(x)) +
xlab("County") +
#ylab(expression("Pr"~(list("Number of Invasions",X>=x))))+
ylab(expression("Annual Sustained Winds"~list("Number of Invasions",X>=x))) +
#ylab(paste(expression("Annual Sustained Winds \u2265 34 knots (ln - hrs)"))) +
#ylab("Annual Sustained Winds >= 34 knots (ln - hrs)") +
ggtitle("Exposure to Tropical Storms: Test Sample") +
# guides(
#   color = guide_legend(order = 2),
#   shape = guide_legend(order = 1),
#   linetype = guide_legend(order = 2)
# ) +
theme(legend.spacing.y = unit(-0.25, "cm"),
legend.direction = "vertical",
legend.box = "vertical",
legend.position = c(.225, .85),
plot.title = element_text(hjust = 0.5)
)
print(p)
}
plot_filtering_estimates2(gg)
?list
plot_filtering_estimates2 <- function(df) {
p = ggplot() +
theme_classic() +
geom_hline(yintercept = mean(gg_wind$actual, na.rm = T), linetype="dashed", color = "gray50", alpha = 0.85) +
geom_line(data = gg_wind_all, aes(x = index, y = ypred, color = Model, lty = Model, alpha = Model)) +
scale_color_manual(
values = color_vec,
labels = c("Actual",
bquote("BART (" * R^2 ~ "=" ~ .(rsq_bart_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_bart_wind) * ")"),
bquote("eNET (" * R^2 ~ "=" ~ .(rsq_lre_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_lre_wind) * ")"),
bquote("XGB (" * R^2 ~ "=" ~ .(rsq_xgb_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_xgb_wind) * ")")
),
name = element_blank()) +
scale_linetype_manual(
values = lty_vec,
labels = c("Actual",
bquote("BART (" * R^2 ~ "=" ~ .(rsq_bart_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_bart_wind) * ")"),
bquote("eNET (" * R^2 ~ "=" ~ .(rsq_lre_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_lre_wind) * ")"),
bquote("XGB (" * R^2 ~ "=" ~ .(rsq_xgb_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_xgb_wind) * ")")
),
name = element_blank()) +
scale_alpha_manual(
values = alpha_vec,
labels = c("Actual",
bquote("BART (" * R^2 ~ "=" ~ .(rsq_bart_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_bart_wind) * ")"),
bquote("eNET (" * R^2 ~ "=" ~ .(rsq_lre_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_lre_wind) * ")"),
bquote("XGB (" * R^2 ~ "=" ~ .(rsq_xgb_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_xgb_wind) * ")")
),
name = element_blank()) +
scale_y_continuous(labels = function(x) paste0(x)) +
xlab("County") +
#ylab(expression("Pr"~(list("Number of Invasions",X>=x))))+
ylab(expression("Annual Sustained Winds"~X>=x)) +
#ylab(paste(expression("Annual Sustained Winds \u2265 34 knots (ln - hrs)"))) +
#ylab("Annual Sustained Winds >= 34 knots (ln - hrs)") +
ggtitle("Exposure to Tropical Storms: Test Sample") +
# guides(
#   color = guide_legend(order = 2),
#   shape = guide_legend(order = 1),
#   linetype = guide_legend(order = 2)
# ) +
theme(legend.spacing.y = unit(-0.25, "cm"),
legend.direction = "vertical",
legend.box = "vertical",
legend.position = c(.225, .85),
plot.title = element_text(hjust = 0.5)
)
print(p)
}
plot_filtering_estimates2(gg)
plot_filtering_estimates2 <- function(df) {
p = ggplot() +
theme_classic() +
geom_hline(yintercept = mean(gg_wind$actual, na.rm = T), linetype="dashed", color = "gray50", alpha = 0.85) +
geom_line(data = gg_wind_all, aes(x = index, y = ypred, color = Model, lty = Model, alpha = Model)) +
scale_color_manual(
values = color_vec,
labels = c("Actual",
bquote("BART (" * R^2 ~ "=" ~ .(rsq_bart_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_bart_wind) * ")"),
bquote("eNET (" * R^2 ~ "=" ~ .(rsq_lre_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_lre_wind) * ")"),
bquote("XGB (" * R^2 ~ "=" ~ .(rsq_xgb_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_xgb_wind) * ")")
),
name = element_blank()) +
scale_linetype_manual(
values = lty_vec,
labels = c("Actual",
bquote("BART (" * R^2 ~ "=" ~ .(rsq_bart_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_bart_wind) * ")"),
bquote("eNET (" * R^2 ~ "=" ~ .(rsq_lre_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_lre_wind) * ")"),
bquote("XGB (" * R^2 ~ "=" ~ .(rsq_xgb_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_xgb_wind) * ")")
),
name = element_blank()) +
scale_alpha_manual(
values = alpha_vec,
labels = c("Actual",
bquote("BART (" * R^2 ~ "=" ~ .(rsq_bart_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_bart_wind) * ")"),
bquote("eNET (" * R^2 ~ "=" ~ .(rsq_lre_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_lre_wind) * ")"),
bquote("XGB (" * R^2 ~ "=" ~ .(rsq_xgb_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_xgb_wind) * ")")
),
name = element_blank()) +
scale_y_continuous(labels = function(x) paste0(x)) +
xlab("County") +
#ylab(expression("Pr"~(list("Number of Invasions",X>=x))))+
ylab(expression("Annual Sustained Winds"~>=x)) +
plot_filtering_estimates2 <- function(df) {
p = ggplot() +
theme_classic() +
geom_hline(yintercept = mean(gg_wind$actual, na.rm = T), linetype="dashed", color = "gray50", alpha = 0.85) +
geom_line(data = gg_wind_all, aes(x = index, y = ypred, color = Model, lty = Model, alpha = Model)) +
scale_color_manual(
values = color_vec,
labels = c("Actual",
bquote("BART (" * R^2 ~ "=" ~ .(rsq_bart_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_bart_wind) * ")"),
bquote("eNET (" * R^2 ~ "=" ~ .(rsq_lre_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_lre_wind) * ")"),
bquote("XGB (" * R^2 ~ "=" ~ .(rsq_xgb_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_xgb_wind) * ")")
),
name = element_blank()) +
scale_linetype_manual(
values = lty_vec,
labels = c("Actual",
bquote("BART (" * R^2 ~ "=" ~ .(rsq_bart_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_bart_wind) * ")"),
bquote("eNET (" * R^2 ~ "=" ~ .(rsq_lre_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_lre_wind) * ")"),
bquote("XGB (" * R^2 ~ "=" ~ .(rsq_xgb_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_xgb_wind) * ")")
),
name = element_blank()) +
scale_alpha_manual(
values = alpha_vec,
labels = c("Actual",
bquote("BART (" * R^2 ~ "=" ~ .(rsq_bart_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_bart_wind) * ")"),
bquote("eNET (" * R^2 ~ "=" ~ .(rsq_lre_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_lre_wind) * ")"),
bquote("XGB (" * R^2 ~ "=" ~ .(rsq_xgb_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_xgb_wind) * ")")
),
name = element_blank()) +
scale_y_continuous(labels = function(x) paste0(x)) +
xlab("County") +
#ylab(expression("Pr"~(list("Number of Invasions",X>=x))))+
ylab(expression("Annual Sustained"~Winds>=x)) +
#ylab(paste(expression("Annual Sustained Winds \u2265 34 knots (ln - hrs)"))) +
#ylab("Annual Sustained Winds >= 34 knots (ln - hrs)") +
ggtitle("Exposure to Tropical Storms: Test Sample") +
# guides(
#   color = guide_legend(order = 2),
#   shape = guide_legend(order = 1),
#   linetype = guide_legend(order = 2)
# ) +
theme(legend.spacing.y = unit(-0.25, "cm"),
legend.direction = "vertical",
legend.box = "vertical",
legend.position = c(.225, .85),
plot.title = element_text(hjust = 0.5)
)
print(p)
}
plot_filtering_estimates2(gg)
plot_filtering_estimates2(gg)
plot_filtering_estimates2 <- function(df) {
p = ggplot() +
theme_classic() +
geom_hline(yintercept = mean(gg_wind$actual, na.rm = T), linetype="dashed", color = "gray50", alpha = 0.85) +
geom_line(data = gg_wind_all, aes(x = index, y = ypred, color = Model, lty = Model, alpha = Model)) +
scale_color_manual(
values = color_vec,
labels = c("Actual",
bquote("BART (" * R^2 ~ "=" ~ .(rsq_bart_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_bart_wind) * ")"),
bquote("eNET (" * R^2 ~ "=" ~ .(rsq_lre_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_lre_wind) * ")"),
bquote("XGB (" * R^2 ~ "=" ~ .(rsq_xgb_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_xgb_wind) * ")")
),
name = element_blank()) +
scale_linetype_manual(
values = lty_vec,
labels = c("Actual",
bquote("BART (" * R^2 ~ "=" ~ .(rsq_bart_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_bart_wind) * ")"),
bquote("eNET (" * R^2 ~ "=" ~ .(rsq_lre_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_lre_wind) * ")"),
bquote("XGB (" * R^2 ~ "=" ~ .(rsq_xgb_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_xgb_wind) * ")")
),
name = element_blank()) +
scale_alpha_manual(
values = alpha_vec,
labels = c("Actual",
bquote("BART (" * R^2 ~ "=" ~ .(rsq_bart_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_bart_wind) * ")"),
bquote("eNET (" * R^2 ~ "=" ~ .(rsq_lre_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_lre_wind) * ")"),
bquote("XGB (" * R^2 ~ "=" ~ .(rsq_xgb_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_xgb_wind) * ")")
),
name = element_blank()) +
scale_y_continuous(labels = function(x) paste0(x)) +
xlab("County") +
#ylab(expression("Pr"~(list("Number of Invasions",X>=x))))+
ylab(expression("Annual Sustained"~Winds>=x~"34 knots")) +
#ylab(paste(expression("Annual Sustained Winds \u2265 34 knots (ln - hrs)"))) +
#ylab("Annual Sustained Winds >= 34 knots (ln - hrs)") +
ggtitle("Exposure to Tropical Storms: Test Sample") +
# guides(
#   color = guide_legend(order = 2),
#   shape = guide_legend(order = 1),
#   linetype = guide_legend(order = 2)
# ) +
theme(legend.spacing.y = unit(-0.25, "cm"),
legend.direction = "vertical",
legend.box = "vertical",
legend.position = c(.225, .85),
plot.title = element_text(hjust = 0.5)
)
print(p)
}
plot_filtering_estimates2(gg)
plot_filtering_estimates2 <- function(df) {
p = ggplot() +
theme_classic() +
geom_hline(yintercept = mean(gg_wind$actual, na.rm = T), linetype="dashed", color = "gray50", alpha = 0.85) +
geom_line(data = gg_wind_all, aes(x = index, y = ypred, color = Model, lty = Model, alpha = Model)) +
scale_color_manual(
values = color_vec,
labels = c("Actual",
bquote("BART (" * R^2 ~ "=" ~ .(rsq_bart_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_bart_wind) * ")"),
bquote("eNET (" * R^2 ~ "=" ~ .(rsq_lre_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_lre_wind) * ")"),
bquote("XGB (" * R^2 ~ "=" ~ .(rsq_xgb_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_xgb_wind) * ")")
),
name = element_blank()) +
scale_linetype_manual(
values = lty_vec,
labels = c("Actual",
bquote("BART (" * R^2 ~ "=" ~ .(rsq_bart_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_bart_wind) * ")"),
bquote("eNET (" * R^2 ~ "=" ~ .(rsq_lre_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_lre_wind) * ")"),
bquote("XGB (" * R^2 ~ "=" ~ .(rsq_xgb_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_xgb_wind) * ")")
),
name = element_blank()) +
scale_alpha_manual(
values = alpha_vec,
labels = c("Actual",
bquote("BART (" * R^2 ~ "=" ~ .(rsq_bart_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_bart_wind) * ")"),
bquote("eNET (" * R^2 ~ "=" ~ .(rsq_lre_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_lre_wind) * ")"),
bquote("XGB (" * R^2 ~ "=" ~ .(rsq_xgb_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_xgb_wind) * ")")
),
name = element_blank()) +
scale_y_continuous(labels = function(x) paste0(x)) +
xlab("County") +
#ylab(expression("Pr"~(list("Number of Invasions",X>=x))))+
ylab(expression("Annual Sustained"~Winds>=34~"knots")) +
#ylab(paste(expression("Annual Sustained Winds \u2265 34 knots (ln - hrs)"))) +
#ylab("Annual Sustained Winds >= 34 knots (ln - hrs)") +
ggtitle("Exposure to Tropical Storms: Test Sample") +
# guides(
#   color = guide_legend(order = 2),
#   shape = guide_legend(order = 1),
#   linetype = guide_legend(order = 2)
# ) +
theme(legend.spacing.y = unit(-0.25, "cm"),
legend.direction = "vertical",
legend.box = "vertical",
legend.position = c(.225, .85),
plot.title = element_text(hjust = 0.5)
)
print(p)
}
plot_filtering_estimates2(gg)
plot_filtering_estimates2 <- function(df) {
p = ggplot() +
theme_classic() +
geom_hline(yintercept = mean(gg_wind$actual, na.rm = T), linetype="dashed", color = "gray50", alpha = 0.85) +
geom_line(data = gg_wind_all, aes(x = index, y = ypred, color = Model, lty = Model, alpha = Model)) +
scale_color_manual(
values = color_vec,
labels = c("Actual",
bquote("BART (" * R^2 ~ "=" ~ .(rsq_bart_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_bart_wind) * ")"),
bquote("eNET (" * R^2 ~ "=" ~ .(rsq_lre_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_lre_wind) * ")"),
bquote("XGB (" * R^2 ~ "=" ~ .(rsq_xgb_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_xgb_wind) * ")")
),
name = element_blank()) +
scale_linetype_manual(
values = lty_vec,
labels = c("Actual",
bquote("BART (" * R^2 ~ "=" ~ .(rsq_bart_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_bart_wind) * ")"),
bquote("eNET (" * R^2 ~ "=" ~ .(rsq_lre_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_lre_wind) * ")"),
bquote("XGB (" * R^2 ~ "=" ~ .(rsq_xgb_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_xgb_wind) * ")")
),
name = element_blank()) +
scale_alpha_manual(
values = alpha_vec,
labels = c("Actual",
bquote("BART (" * R^2 ~ "=" ~ .(rsq_bart_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_bart_wind) * ")"),
bquote("eNET (" * R^2 ~ "=" ~ .(rsq_lre_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_lre_wind) * ")"),
bquote("XGB (" * R^2 ~ "=" ~ .(rsq_xgb_wind) * "," ~ RMSE[cv] ~ "=" ~ .(cverror_xgb_wind) * ")")
),
name = element_blank()) +
scale_y_continuous(labels = function(x) paste0(x)) +
xlab("County") +
#ylab(expression("Pr"~(list("Number of Invasions",X>=x))))+
ylab(expression("Annual Sustained"~Winds>=34~"knots (ln - hrs)")) +
#ylab(paste(expression("Annual Sustained Winds \u2265 34 knots (ln - hrs)"))) +
#ylab("Annual Sustained Winds >= 34 knots (ln - hrs)") +
ggtitle("Exposure to Tropical Storms: Test Sample") +
# guides(
#   color = guide_legend(order = 2),
#   shape = guide_legend(order = 1),
#   linetype = guide_legend(order = 2)
# ) +
theme(legend.spacing.y = unit(-0.25, "cm"),
legend.direction = "vertical",
legend.box = "vertical",
legend.position = c(.225, .85),
plot.title = element_text(hjust = 0.5)
)
print(p)
}
plot_filtering_estimates2(gg)
gg3 = ggplot()+
#geom_sf(data = hr_zoom, aes(fill = Hours), color = NA) +
geom_sf(data = hr_zoom, aes(fill = sum_sust_hrs / 5), color = NA) +
scale_fill_viridis_c(option="plasma", na.value = "grey30") +
geom_sf(data = county_zoom, fill = NA, color = "black", lwd = 0.1) +
theme_dark() +
#labs(title = "Annual Power Outages\nTropical Storms (2015 - 2019)", fill = "Hours") +
#labs(title = "Annual Exposure to Sustained Winds \u2265 34 knots\nTropical Storms (2015 - 2019)", fill = "Hours") +
labs(title = expression("Annual Exposure to Sustained"~Winds>=34~"knots\n Tropical Storms (2015 - 2019"), fill = "Hours") +
theme(plot.title = element_text(hjust = 0.5),
axis.title.x = element_blank(),
axis.title.y = element_blank()
)
print(gg3)
gg3 = ggplot()+
#geom_sf(data = hr_zoom, aes(fill = Hours), color = NA) +
geom_sf(data = hr_zoom, aes(fill = sum_sust_hrs / 5), color = NA) +
scale_fill_viridis_c(option="plasma", na.value = "grey30") +
geom_sf(data = county_zoom, fill = NA, color = "black", lwd = 0.1) +
theme_dark() +
#labs(title = "Annual Power Outages\nTropical Storms (2015 - 2019)", fill = "Hours") +
#labs(title = "Annual Exposure to Sustained Winds \u2265 34 knots\nTropical Storms (2015 - 2019)", fill = "Hours") +
labs(title = paste(expression("Annual Exposure to Sustained"~Winds>=34~"knots\n Tropical Storms (2015 - 2019")), fill = "Hours") +
theme(plot.title = element_text(hjust = 0.5),
axis.title.x = element_blank(),
axis.title.y = element_blank()
)
print(gg3)
gg3 = ggplot()+
#geom_sf(data = hr_zoom, aes(fill = Hours), color = NA) +
geom_sf(data = hr_zoom, aes(fill = sum_sust_hrs / 5), color = NA) +
scale_fill_viridis_c(option="plasma", na.value = "grey30") +
geom_sf(data = county_zoom, fill = NA, color = "black", lwd = 0.1) +
theme_dark() +
#labs(title = "Annual Power Outages\nTropical Storms (2015 - 2019)", fill = "Hours") +
#labs(title = "Annual Exposure to Sustained Winds \u2265 34 knots\nTropical Storms (2015 - 2019)", fill = "Hours") +
labs(title = expression(atop("Annual Exposure to Sustained"~Winds>=34~"knots", paste("Tropical Storms (2015 - 2019)"))), fill = "Hours") +
theme(plot.title = element_text(hjust = 0.5),
axis.title.x = element_blank(),
axis.title.y = element_blank()
)
print(gg3)
gg3 = ggplot()+
geom_sf(data = hr_zoom, aes(fill = Hours), color = NA) +
#geom_sf(data = hr_zoom, aes(fill = sum_sust_hrs / 5), color = NA) +
scale_fill_viridis_c(option="plasma", na.value = "grey30") +
geom_sf(data = county_zoom, fill = NA, color = "black", lwd = 0.1) +
theme_dark() +
#labs(title = "Annual Power Outages\nTropical Storms (2015 - 2019)", fill = "Hours") +
#labs(title = "Annual Exposure to Sustained Winds \u2265 34 knots\nTropical Storms (2015 - 2019)", fill = "Hours") +
labs(title = expression(atop("Annual Power Outages", paste("Tropical Storms (2015 - 2019)"))), fill = "Hours") +
#labs(title = expression(atop("Annual Exposure to Sustained"~Winds>=34~"knots", paste("Tropical Storms (2015 - 2019)"))), fill = "Hours") +
theme(plot.title = element_text(hjust = 0.5),
axis.title.x = element_blank(),
axis.title.y = element_blank()
)
print(gg3)
save.image("~/vSandia2/Data/Exposure/Hurricane_exposure_hrs.RData")
final_model = xgb_work %>%
finalize_workflow(xgb_best) %>%
fit(df_data)
final_obj = extract_fit_parsnip(final_model)$fit
importance = xgb.importance(model = final_obj)
head(importance, n = 20)
vip(final_obj, n = 20)
wind_final_model = wind_xgb_work %>%
finalize_workflow(wind_xgb_best) %>%
fit(df_data_WIND)
wind_final_obj = extract_fit_parsnip(wind_final_model)$fit
wind_importance = xgb.importance(model = wind_final_obj)
head(wind_importance, n = 20)
vip(wind_final_obj, n = 20)
save.image("~/vSandia2/Data/Exposure/Hurricane_exposure_hrs.RData")
